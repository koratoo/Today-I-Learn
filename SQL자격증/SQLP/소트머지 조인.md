소트 머지 조인(Sort-Merge Join)은 데이터베이스에서 두 테이블을 조인할 때 사용하는 알고리즘 중 하나로, 특히 **정렬된 데이터**나 **대용량 데이터**를 조인할 때 효과적인 방식입니다.

---

### 📌 핵심 개념
1. **Sort(정렬)**: 두 테이블을 조인 조건에 따라 정렬합니다. (예: `ON A.id = B.id`)
2. **Merge(병합)**: 정렬된 두 테이블을 포인터 두 개로 각각 순회하면서 같은 키를 가진 행끼리 조인합니다.

---

### 💡 작동 방식 (간단한 예시)

```sql
SELECT *
FROM A
JOIN B ON A.id = B.id;
```

#### 테이블 A (정렬된 상태)
| id | name  |
|----|-------|
| 1  | Alice |
| 2  | Bob   |
| 3  | Carol |

#### 테이블 B (정렬된 상태)
| id | age |
|----|-----|
| 1  | 20  |
| 2  | 30  |
| 3  | 40  |

#### 1. 정렬 (Sort)
- A.id, B.id 기준으로 정렬 (이미 되어 있다고 가정)

#### 2. 머지 (Merge)
- A의 첫 행과 B의 첫 행을 비교해서 `id`가 같으면 조인
- 같지 않으면 더 작은 쪽 포인터를 이동
- 포인터를 양쪽에서 하나씩 이동해가며 매칭되는 것만 조인

---

### ✅ 장점
- 인덱스 없이도 정렬 후 사용 가능
- 대용량 데이터를 처리할 때 성능이 좋음 (특히 정렬된 상태거나, 정렬된 데이터를 스트리밍할 수 있을 때)

---

### ⚠️ 단점
- 정렬 비용이 크면 오히려 느릴 수 있음
- 양쪽 테이블이 모두 정렬되어야 효과적임

---

### 🔁 해시 조인 vs 소트 머지 조인

| 비교 항목       | 해시 조인 (Hash Join) | 소트 머지 조인 (Sort-Merge Join) |
|----------------|------------------------|----------------------------------|
| 정렬 필요 여부 | ❌ 불필요              | ✅ 필요                           |
| 메모리 사용량   | 큼                    | 상대적으로 적음                 |
| 인덱스 유무 영향| 영향 없음             | 인덱스 있으면 빠름               |
| 데이터 크기     | 작을 때 유리           | 클 때 유리 (특히 정렬 상태면 더 좋음) |

---
